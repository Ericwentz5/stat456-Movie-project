"St. Thomas",  "Alaska Anchorage",  "Loss",  "200:00", NA, 0.80, 0.92, 42.2, 18.9, 43.1, 18.3, 46.7, 35.0, 25.0, 70.0, 45.5, NA, 13.3, 1.60, 16.0, 10.5, 16.0,
"St. Thomas",  "NJIT",              "Win",   "200:00", NA, 0.93, 1.31, 61.7, 13.9, 30.8, 14.7, 58.8, 26.5, 28.6, 68.8, 52.8, NA, 28.8, 0.52, 10.1, 16.7, 26.6,
"St. Thomas",  "Eastern Michigan",  "Win",   "200:00", NA, 0.66, 0.85, 36.1, 17.5, 34.4, 25.0, 46.2, 28.8, 26.3, 84.4, 52.9, NA, 22.8, 0.56, 17.3, 6.3, 21.3,
"St. Thomas",  "Army",              "Win",   "200:00", NA, 0.87, 1.08, 54.5, 15.6, 27.4, 10.4, 53.7, 35.8, 39.4, 69.0, 53.2, NA, 19.5, 1.13, 9.7, 7.7, 27.8,
"St. Thomas",  "Iowa State",        "Win",   "200:00", NA, 1.05, 1.18, 54.8, 19.6, 36.1, 18.8, 49.4, 31.8, 40.6, 74.4, 59.2, NA, 11.1, 2.56, 10.7, 17.2, 22.7
)
View(opponent_Adv_thru_dec9)
Toms_Adv_thru_dec9 <- Toms_Adv_thru_dec9 %>%
mutate(team_type = "team")
opponent_Adv_thru_dec9 <- opponent_Adv_thru_dec9 %>%
mutate(team_type = "opponent")
stm_all <- bind_rows(Toms_Adv_thru_dec9, opponent_Adv_thru_dec9)
stm_all <- stm_all %>%
mutate(win = factor(result, levels = c("Loss", "Win")))
View(stm_all)
league_avg <- stm_all %>%
summarize(efg_avg = mean(EFG, na.rm = TRUE))
ggplot(stm_all, aes(x = EFG, fill = win)) +
geom_density(alpha = 0.6) +
geom_vline(
xintercept = league_avg$efg_avg,
linetype = "dotted",
color = "black",
size = 1
) +
facet_wrap(~team_type, nrow = 1) +
labs(
title = "Effective FG% Distribution: St. Thomas vs Opponents",
subtitle = "Faceted by team — Dotted line = Overall Average EFG%",
x = "Effective FG%",
y = "Density",
fill = "Game Result"
) +
scale_fill_manual(values = c("Loss" = "red", "Win" = "forestgreen")) +
theme_minimal(base_size = 14) +
theme(
legend.position = "top",
strip.text = element_text(size = 13, face = "bold")
)
stm_all <- stm_all %>%
mutate(team_type = if_else(team_type == "team", "St. Thomas", "Opponent"))
ggplot(stm_all, aes(x = EFG, fill = win)) +
geom_density(alpha = 0.6) +
geom_vline(
xintercept = league_avg$efg_avg,
linetype = "dotted",
color = "black",
size = 1
) +
facet_wrap(~team_type, nrow = 1) +
labs(
title = "Effective FG% Distribution: St. Thomas vs Opponents",
subtitle = "Faceted by team — Dotted line = Overall Average EFG%",
x = "Effective FG%",
y = "Density",
fill = "Game Result"
) +
scale_fill_manual(values = c("Loss" = "red", "Win" = "forestgreen")) +
theme_minimal(base_size = 14) +
theme(
legend.position = "top",
strip.text = element_text(size = 13, face = "bold")
)
ggplot(stm_all, aes(x = EFG, fill = win)) +
geom_density(alpha = 0.6) +
geom_vline(
xintercept = league_avg$efg_avg,
linetype = "dotted",
color = "black",
size = 1
) +
facet_wrap(~team_type, nrow = 1) +
labs(
title = "Effective FG% Distribution: St. Thomas vs Opponents",
subtitle = "Faceted by team — Dotted line = Overall Average EFG%",
x = "Effective FG%",
y = "Density",
fill = "Game Result"
) +
scale_fill_manual(values = c("Loss" = "black", "Win" = "purple")) +
theme_minimal(base_size = 14) +
theme(
legend.position = "top",
strip.text = element_text(size = 13, face = "bold")
)
library(tidyverse)
oreb_summary <- Toms_Adv_thru_dec9 %>%
# Toms_Adv_thru_dec9 already has St. Thomas stats + result
left_join(
opponent_Adv_thru_dec9 %>%
select(opponent, opp_oreb_pct = ORB),  # rename opponent OREB%
by = "opponent"
) %>%
group_by(result) %>%
summarise(
stt_avg = mean(ORB, na.rm = TRUE),            # St. Thomas offensive rebounding
opp_avg = mean(opp_oreb_pct, na.rm = TRUE)    # Opponent offensive rebounding
) %>%
pivot_longer(cols = c(stt_avg, opp_avg),
names_to = "team",
values_to = "oreb") %>%
mutate(
team = factor(team,
levels = c("stt_avg", "opp_avg"),
labels = c("St. Thomas", "Opponents")),
win = factor(result,
levels = c("Loss", "Win"),
labels = c("Loss", "Win"))
)
league_avg_oreb <- mean(c(Toms_Adv_thru_dec9$ORB,
opponent_Adv_thru_dec9$ORB),
na.rm = TRUE)
ggplot(oreb_summary, aes(x = team, y = oreb, fill = win)) +
geom_bar(stat = "identity", position = "dodge") +
geom_hline(
yintercept = league_avg_oreb,
linetype = "dotted",
color = "red",
size = 1
) +
labs(
title = "Average OREB% by Outcome",
subtitle = "St. Thomas vs Opponents | Dotted line = Overall Average",
x = "Team",
y = "Average OREB%",
fill = "Game Result"
) +
scale_fill_manual(values = c("Loss" = "red", "Win" = "forestgreen")) +
theme_minimal(base_size = 14)
ggplot(oreb_summary, aes(x = team, y = oreb, fill = win)) +
geom_bar(stat = "identity", position = "dodge") +
geom_hline(
yintercept = league_avg_oreb,
linetype = "dotted",
color = "yellow",
size = 1
) +
labs(
title = "Average OREB% by Outcome",
subtitle = "St. Thomas vs Opponents | Dotted line = Overall Average",
x = "Team",
y = "Average OREB%",
fill = "Game Result"
) +
scale_fill_manual(values = c("Loss" = "black", "Win" = "purple")) +
theme_minimal(base_size = 14)
ggplot(oreb_summary, aes(x = team, y = oreb, fill = win)) +
geom_bar(stat = "identity", position = "dodge") +
geom_hline(
yintercept = league_avg_oreb,
linetype = "dotted",
color = "yellow",
size = 1
) +
labs(
title = "Average OREB% by Outcome",
subtitle = "St. Thomas vs Opponents | Dotted line = Overall Average",
x = "Team",
y = "Average OREB%",
fill = "Game Result"
) +
scale_fill_manual(values = c("Tommies Loss" = "black", "Tommies Win" = "purple")) +
theme_minimal(base_size = 14)
ggplot(oreb_summary, aes(x = team, y = oreb, fill = win)) +
geom_bar(stat = "identity", position = "dodge") +
geom_hline(
yintercept = league_avg_oreb,
linetype = "dotted",
color = "yellow",
size = 1
) +
labs(
title = "Average OREB% by Outcome",
subtitle = "St. Thomas vs Opponents | Dotted line = Overall Average",
x = "Team",
y = "Average OREB%",
fill = "Game Result"
) +
scale_fill_manual(values = c("Loss" = "black", "Win" = "purple")) +
theme_minimal(base_size = 14)
ggplot(oreb_summary, aes(x = team, y = oreb, fill = win)) +
geom_bar(stat = "identity", position = "dodge") +
geom_hline(
yintercept = league_avg_oreb,
linetype = "dotted",
color = "yellow",
size = 1
) +
labs(
title = "Average OREB% by Tommies' Outcomes",
subtitle = "St. Thomas vs Opponents | Dotted line = Overall Average",
x = "Team",
y = "Average OREB%",
fill = "Game Result"
) +
scale_fill_manual(values = c("Loss" = "black", "Win" = "purple")) +
theme_minimal(base_size = 14)
ggplot(stm_all, aes(x = EFG, fill = win)) +
geom_density(alpha = 0.6) +
geom_vline(
xintercept = league_avg$efg_avg,
linetype = "dotted",
color = "black",
size = 1
) +
facet_wrap(~team_type, nrow = 1) +
labs(
title = "Effective FG% Distribution: St. Thomas vs Opponents",
subtitle = "Faceted by team — Dotted line = Overall Average EFG%",
x = "Effective FG%",
y = "Density",
fill = "Game Result"
) +
scale_fill_manual(values = c("Loss" = "black", "Win" = "purple")) +
theme_minimal(base_size = 14) +
theme(
legend.position = "top",
strip.text = element_text(size = 13, face = "bold")
)
Toms_Adv_thru_dec9 <- Toms_Adv_thru_dec9 %>%
mutate(team_type = "team")
opponent_Adv_thru_dec9 <- opponent_Adv_thru_dec9 %>%
mutate(team_type = "opponent")
opponent_Adv_thru_dec9 <- opponent_Adv_thru_dec9 %>%
mutate(
team_type = "Opponent",
result = Toms_Adv_thru_dec9$result   # MATCH ST. THOMAS RESULT
)
stm_all <- bind_rows(Toms_Adv_thru_dec9, opponent_Adv_thru_dec9)
stm_all <- stm_all %>%
mutate(team_type = if_else(team_type == "team", "St. Thomas", "Opponent"))
league_avg <- stm_all %>%
summarize(efg_avg = mean(EFG, na.rm = TRUE))
ggplot(stm_all, aes(x = EFG, fill = win)) +
geom_density(alpha = 0.6) +
geom_vline(
xintercept = league_avg$efg_avg,
linetype = "dotted",
color = "black",
size = 1
) +
facet_wrap(~team_type, nrow = 1) +
labs(
title = "Effective FG% Distribution: St. Thomas vs Opponents",
subtitle = "Faceted by team — Dotted line = Overall Average EFG%",
x = "Effective FG%",
y = "Density",
fill = "Game Result"
) +
scale_fill_manual(values = c("Loss" = "black", "Win" = "purple")) +
theme_minimal(base_size = 14) +
theme(
legend.position = "top",
strip.text = element_text(size = 13, face = "bold")
)
View(stm_all)
ggplot(stm_all, aes(x = EFG, fill = result)) +
geom_density(alpha = 0.6) +
geom_vline(
xintercept = league_avg$efg_avg,
linetype = "dotted",
color = "black",
size = 1
) +
facet_wrap(~team_type, nrow = 1) +
labs(
title = "Effective FG% Distribution: St. Thomas vs Opponents",
subtitle = "Faceted by team — Dotted line = Overall Average EFG%",
x = "Effective FG%",
y = "Density",
fill = "Game Result"
) +
scale_fill_manual(values = c("Loss" = "black", "Win" = "purple")) +
theme_minimal(base_size = 14) +
theme(
legend.position = "top",
strip.text = element_text(size = 13, face = "bold")
)
View(Toms_Adv_thru_dec9)
dates <- as.Date(c(
"2025-11-03",
"2025-11-08",
"2025-11-14",
"2025-11-16",
"2025-11-21",
"2025-11-22",
"2025-11-26",
"2025-11-30",
"2025-12-03",
"2025-12-06"
))
dates <- rev(dates)
Toms_Adv_thru_dec9 <- Toms_Adv_thru_dec9 %>%
mutate(date = dates)
opponent_Adv_thru_dec9 <- opponent_Adv_thru_dec9 %>%
mutate(date = dates)
View(Toms_Adv_thru_dec9)
library(tidyverse)
ft_long <- Toms_Adv_thru_dec9 %>%
select(date, result, stt_ft = FT_rate) %>%
left_join(
opponent_Adv_thru_dec9 %>%
select(date, opp_ft = FT_rate),
by = "date"
) %>%
pivot_longer(
cols = c(stt_ft, opp_ft),
names_to = "team_type",
values_to = "ft_rate"
) %>%
mutate(
team_type = factor(
team_type,
levels = c("stt_ft", "opp_ft"),
labels = c("St. Thomas", "Opponent")
),
dot_color = if_else(result == "Win", "Win", "Loss")
)
ggplot(ft_long, aes(x = date, y = ft_rate, group = team_type, color = team_type)) +
# Lines
geom_line(size = 1.1, alpha = 0.7) +
# Dots (purple = win, black = loss)
geom_point(aes(fill = dot_color),
shape = 21,
color = "white",
size = 4,
stroke = 0.4) +
scale_color_manual(values = c("St. Thomas" = "purple",
"Opponent" = "gray40")) +
scale_fill_manual(values = c("Win" = "purple",
"Loss" = "black")) +
labs(
title = "FT Rate Over Time: St. Thomas vs Opponents",
subtitle = "Purple = Win | Black = Loss",
x = "Game Date",
y = "FT Rate",
color = "Team",
fill = "Game Result"
) +
theme_minimal(base_size = 14) +
theme(
legend.position = "top",
axis.text.x = element_text(angle = 45, hjust = 1)
)
ggplot(ft_long, aes(x = date, y = ft_rate, group = team_type, color = team_type)) +
# Lines
geom_line(size = 1.1, alpha = 0.7) +
# Dots (using your color rules)
geom_point(aes(fill = dot_color),
shape = 21,
color = "white",
size = 4,
stroke = 0.4) +
scale_color_manual(values = c("St. Thomas" = "purple",
"Opponent" = "gray40")) +
scale_fill_identity() +  # <-- IMPORTANT: uses actual purple/black hex values
labs(
title = "FT Rate Over Time: St. Thomas vs Opponents",
subtitle = "St. Thomas: Purple in Wins | Opponent: Purple in Losses",
x = "Game Date",
y = "FT Rate",
color = "Team"
) +
theme_minimal(base_size = 14) +
theme(
legend.position = "top",
axis.text.x = element_text(angle = 45, hjust = 1)
)
ft_long <- Toms_Adv_thru_dec9 %>%
select(date, result, stt_ft = FT_rate) %>%
left_join(
opponent_Adv_thru_dec9 %>%
select(date, opp_ft = FT_rate),
by = "date"
) %>%
pivot_longer(
cols = c(stt_ft, opp_ft),
names_to = "team_type",
values_to = "ft_rate"
) %>%
mutate(
team_type = factor(team_type,
levels = c("stt_ft", "opp_ft"),
labels = c("St. Thomas", "Opponent")),
# DOT COLOR RULES:
dot_color = case_when(
result == "Win"  & team_type == "St. Thomas" ~ "purple",
result == "Win"  & team_type == "Opponent"   ~ "black",
result == "Loss" & team_type == "St. Thomas" ~ "black",
result == "Loss" & team_type == "Opponent"   ~ "purple"
)
)
ggplot(ft_long, aes(x = date, y = ft_rate, group = team_type, color = team_type)) +
# Lines
geom_line(size = 1.1, alpha = 0.7) +
# Dots (using your color rules)
geom_point(aes(fill = dot_color),
shape = 21,
color = "white",
size = 4,
stroke = 0.4) +
scale_color_manual(values = c("St. Thomas" = "purple",
"Opponent" = "gray40")) +
scale_fill_identity() +  # <-- IMPORTANT: uses actual purple/black hex values
labs(
title = "FT Rate Over Time: St. Thomas vs Opponents",
subtitle = "St. Thomas: Purple in Wins | Opponent: Purple in Losses",
x = "Game Date",
y = "FT Rate",
color = "Team"
) +
theme_minimal(base_size = 14) +
theme(
legend.position = "top",
axis.text.x = element_text(angle = 45, hjust = 1)
)
tov_long <- Toms_Adv_thru_dec9 %>%
select(date, result, stt_tov = TOV_rate) %>%
left_join(
opponent_Adv_thru_dec9 %>%
select(date, opp_tov = TOV_rate),
by = "date"
) %>%
pivot_longer(
cols = c(stt_tov, opp_tov),
names_to = "team_type",
values_to = "tov_rate"
) %>%
mutate(
team_type = factor(team_type,
levels = c("stt_tov", "opp_tov"),
labels = c("St. Thomas", "Opponent")),
# DOT COLOR LOGIC (same as FT Rate)
dot_color = case_when(
result == "Win"  & team_type == "St. Thomas" ~ "purple",
result == "Win"  & team_type == "Opponent"   ~ "black",
result == "Loss" & team_type == "St. Thomas" ~ "black",
result == "Loss" & team_type == "Opponent"   ~ "purple"
)
)
tov_long <- Toms_Adv_thru_dec9 %>%
select(date, result, stt_tov = TOV) %>%
left_join(
opponent_Adv_thru_dec9 %>%
select(date, opp_tov = TOV),
by = "date"
) %>%
pivot_longer(
cols = c(stt_tov, opp_tov),
names_to = "team_type",
values_to = "tov_rate"
) %>%
mutate(
team_type = factor(team_type,
levels = c("stt_tov", "opp_tov"),
labels = c("St. Thomas", "Opponent")),
# DOT COLOR LOGIC (same as FT Rate)
dot_color = case_when(
result == "Win"  & team_type == "St. Thomas" ~ "purple",
result == "Win"  & team_type == "Opponent"   ~ "black",
result == "Loss" & team_type == "St. Thomas" ~ "black",
result == "Loss" & team_type == "Opponent"   ~ "purple"
)
)
ggplot(tov_long, aes(x = date, y = tov_rate, group = team_type, color = team_type)) +
# lines
geom_line(size = 1.1, alpha = 0.7) +
# dots with win/loss reversal logic
geom_point(aes(fill = dot_color),
shape = 21,
color = "white",
size = 4,
stroke = 0.4) +
scale_color_manual(values = c("St. Thomas" = "purple",
"Opponent" = "gray40")) +
scale_fill_identity() +
labs(
title = "Turnover Rate Over Time: St. Thomas vs Opponents",
subtitle = "St. Thomas = Purple when winning | Opponent = Purple when St. Thomas loses",
x = "Game Date",
y = "TOV Rate",
color = "Team"
) +
theme_minimal(base_size = 14) +
theme(
legend.position = "top",
axis.text.x = element_text(angle = 45, hjust = 1)
)
ggplot(ft_long, aes(x = date, y = ft_rate, group = team_type, color = team_type)) +
# Lines
geom_line(size = 1.1, alpha = 0.7) +
# Dots (using your color rules)
geom_point(aes(fill = dot_color),
shape = 21,
color = "white",
size = 4,
stroke = 0.4) +
scale_color_manual(values = c("St. Thomas" = "purple",
"Opponent" = "gray40")) +
scale_fill_identity() +  # <-- IMPORTANT: uses actual purple/black hex values
labs(
title = "FT Rate Over Time: St. Thomas vs Opponents",
subtitle = "St. Thomas: Purple in Wins | Opponent: Purple in Losses",
x = "Game Date",
y = "FT Rate",
color = "Team"
) +
theme_minimal(base_size = 14) +
theme(
legend.position = "top",
axis.text.x = element_text(angle = 45, hjust = 1)
)
